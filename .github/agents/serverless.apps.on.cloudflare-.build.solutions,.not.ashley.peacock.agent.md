# Serverless Apps on Cloudflare- Build Solutions, Not Ashley Peacock Agent

## Description
You are an AI assistant specialized in the content of 'Serverless Apps on Cloudflare- Build Solutions, Not Ashley Peacock'. Provide guidance based on the book's knowledge for commercial applications.

## Capabilities
- Answer questions about Serverless Apps on Cloudflare- Build Solutions, Not Ashley Peacock
- Provide examples and best practices
- Recommend tools and implementations for business use

## Instructions
Focus on practical, commercial applications. Emphasize efficiency, scalability, and business value.

## Knowledge Base
# `Serverless Apps` ## `on Cloudflare` ``` Build Solutions, Not Infrastructure Ashley Peacock edited by Michael Swaine ``` **Early Praise for Serverless Apps on Cloudflare** As someone interested in all things serverless, and constantly curious about new technologies, Cloudflare was top of my list of technologies to explore. Ashleys book does an incredible job of walking through, step by step, how to get started building serverless apps on Cloudflare. And Ashley does all of that using practical examples that I can take directly and use in real-world applications saving me countless hours. A must-have for anyone interested in Cloudflare, or anyone building modern serverless applications in general.  James Eastham Serverless DA, Datadog Cloud computing has never been more relevant, and serverless is the natural next evolution of this technology. This book provides everything you need to get started with serverless and Cloudflare, explained in a concise, entertaining way, with excellent examples to really guide the start of your serverless journey.  Adam Cox Software Test Engineer, Simply Business This book is a great introduction to Cloudflare and serverless with detailed stepby-step examples, and everything is well explained. Well worth a read for anyone looking to learn more about this exciting new technology.  Kelvin Samuel Software Engineer, Simply Business This book has been a fantastic introduction to severless as a concept and Cloudflare as a tool. I knew little about either, and since completing the book Ive been able to build serverless applications both on side projects and in my day job.  Robert Faldo Senior Software Engineer, Simply Business We've left this page blank to make the page numbers the same in the electronic and paper books. We tried just leaving it out, but then people wrote us to ask about the missing pages. Anyway, Eddy the Gerbil wanted to say hello. ###### Serverless Apps on Cloudflare Build Solutions, Not Infrastructure Ashley Peacock The Pragmatic Bookshelf Dallas, Texas See our complete catalog of hands-on, practical, and Pragmatic content for software developers: _https://pragprog.com_ Sales, volume licensing, and support: _support@pragprog.com_ Derivative works, AI training and testing, international translations, and other rights: _rights@pragprog.com_ The team that produced this book includes: Publisher: Dave Thomas COO: Janet Furlow Executive Editor: Susannah Davidson Development Editor: Michael Swaine Copy Editor: Vanya Wryter Indexing: Potomac Indexing, LLC Copyright  2024 The Pragmatic Programmers, LLC. All rights reserved. No part of this publication may be reproduced by any means, nor may any derivative works be made from this publiication, nor may this content be used to train or test an artificial intelligence system, without the prior consent of the publisher. When we are aware that a term used in this book is claimed as a trademark, the designation is printed with an initial capital letter or in all capitals. The Pragmatic Starter Kit, The Pragmatic Programmer, Pragmatic Programming, Pragmatic Bookshelf, PragProg, and the linking g device are trademarks of The Pragmatic Programmers, LLC. Every precaution was taken in the preparation of this book. However, the publisher assumes no responsibility for errors or omissions, or for damages that may result from the use of information (including program listings) contained herein. ISBN-13: 979-8-88865-071-4 Encoded using recycled binary digits. Book version: P1.0November 2024 ##### Contents Acknowledgments . . . . . . . . . . . ix Preface . . . . . . . . . . . . . . xi Introduction . . . . . . . . . . . . xiii 1. Deploy Your First Cloudflare Worker . . . . . . . 1 Create a New Worker 2 Configure a Worker 5 Implement Logic in Your Workers 6 Run Scheduled Tasks 8 Deploy Your First Worker 9 What Youve Learned 10 2. Build a Serverless API . . . . . . . . . . 11 Route HTTP Requests 11 Locally Test Workers 14 Define HTTP Handlers 15 Create Resources Using HTTP POST 17 Define Routes with Parameters 19 What Youve Learned 21 3. Run Tests Against a Worker . . . . . . . . . 23 Define the Test Setup 23 Write a Test for 404s 26 Write Tests for GET /images 27 Contents  vi Test POST /images 30 What Youve Learned 32 4. Persist Data with D1 . . . . . . . . . . . 33 Create a D1 Database 34 Connect a Database to a Worker 35 Create a Migration 36 Create Tables 37 Run a Migration 39 Retrieve Multiple Rows 41 Retrieve a Single Row 46 Insert Data 48 What Youve Learned 51 5. Worker-to-Worker Communication . . . . . . . 53 Create the Authentication Worker 54 Make a Worker Private 54 Add Authentication Logic 56 Store Application Secrets 56 Test the Authentication Worker 58 Add a Service Binding 59 Test a Service Binding 62 What Youve Learned 63 6. Build a Static Website with Pages . . . . . . . 65 Create a Pages Project 66 Understand the Project Structure 69 Install Bootstrap 72 Create the Home Page 72 Run the Static Website Locally 75 Deploy a Pages Application 76 What Youve Learned 77 7. Add a Back End to the Front End . . . . . . . 79 Create a Pages Function 80 Create a Serverless Next.js Route 82 Test the Server-Side Endpoint 87 Contents  vii Call the Server-Side Route from the Front End 87 Run the Weather App Locally 94 Deploy a Pages Application 94 What Youve Learned 95 8. Cache Data with KV . . . . . . . . . . . 97 Create a New KV Namespace 98 Bind KV Namespaces 99 Cache Data in KV 100 Test the Caching Locally 108 Deploy to Cloudflare 109 What Youve Learned 110 9. Upload and Store Files on R2 . . . . . . . . 113 Create a New Project 114 Create an R2 Bucket 115 Bind an R2 Bucket 117 Upload Files to R2 117 Create the Front End 119 Test R2 Uploads Locally 125 Deploy to Cloudflare 126 What Youve Learned 127 10. Analyze Images Using Workers AI . . . . . . . 129 Add an AI Binding 129 Execute AI Models 131 Render Image Classification Results 133 Test Applications that Use AI 135 What Youve Learned 137 11. Produce Messages to a Queue . . . . . . . . 139 Add a Queue 142 Publish to a Queue 143 View Messages on the Dashboard 148 What Youve Learned 150 Contents  viii 12. Consume Messages from a Queue . . . . . . . 151 Poll for Analysis 160 Test the Consumer 168 What Youve Learned 168 13. WebSockets with Durable Objects . . . . . . . 171 Create a Worker with Durable Objects 172 Serve HTML from a Worker 175 Create Durable Objects 177 Connect to WebSockets with Durable Objects 179 Handle Server-Side WebSocket Messages 183 Persist Data with Durable Objects 186 Connect to WebSockets with JavaScript 189 What Youve Learned 192 14. Automate Workers & Pages Deployments . . . . . 193 Deploy with Git Integration 194 Deploy Pages with GitHub Actions 197 Configure Wrangler per Environment 203 Deploy a Worker with GitHub Actions 204 Add Secrets 205 Run a GitHub Action 207 Apply Database Migrations 208 What Youve Learned 210 15. Deploy to Production . . . . . . . . . . 213 Register and Transfer Domains 213 Add a Custom Domain to a Project 214 Manage Different Environments 215 View and Query Logs 219 Define Advanced Routes for Workers 221 Deploy Changes Gradually 222 Configure Access to Your Applications 223 Handle Emails 224 Analytics, Security, and Speed 224 What Youve Learned 225 Index . . . . . . . . . . . . . . 227 ##### Acknowledgments In the first book that I wrote, I started the acknowledgments by saying I never thought Id write a book. The same is true when it comes to the second book: I never thought Id write a second book either. On top of that, this book is significantly longer than the first; it blows my mind even now that I was able to write well over 50,000 words about Cloudflare. I couldnt have done it alone though. Id like to thank The Pragmatic Bookshelf for once again believing in my vision for the book, and believing in me as an author. Special thanks to Michael Swaine, who once again edited my book, and had to deal with my many questions and emails throughout the eighteen months it took to write the book. Id also like to thank those who reviewed my book: Adam Cox, Kelvin Samuel, and Rob Faldo. Their feedback and bug finding were essential in making the book as polished, complete, and digestible as possible. It goes without saying that thered be no book without Cloudflare. I want to thank everyone at Cloudflare who brought their developer platform to life, to challenge the status quo set by the likes of AWS, Azure, and GCP. I wrote this book because I believe their platform is incredibly powerful and primarily built with engineers in mind, empowering them to build the best applications they can in the shortest amount of time possible. Not only that, it continues to grow at an astonishing rate. I cant wait to see how it develops in the future. Penultimately, I want to thank and acknowledge my wife, Lia. She is steadfast in her support, and has always been inquisitive throughout the process. From giving me the time and space to write the book, to always asking how its going and whats left to do, her interest and support has meant the world. Lia, I thank you from the bottom of my heart. To round out, I want to thank my family for all they have ever done for me. Without their care, love, and support, I wouldnt be the person I am today. I wouldnt have made it as far as I have in life. Ill be forever grateful for everything theyve ever done for me, and continue to do for me. Im truly thankful. report erratum  discuss ##### Preface Welcome reader, and future Cloudflare and serverless master! This book is all about Cloudflares developer platform and serverless. Ive used the platform extensively, and advocated for others to explore its offering. I believe its platform is the best out there for building applications on, with some of, if not the best, developer experience of any major cloud platform. **Who Should Read This Book?** This book is primarily aimed at anyone working with software and application development. Whether youre an engineer, architect, or CT  # Truncated for file size
